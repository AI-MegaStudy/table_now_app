# Table Now 앱 구조 및 화면 흐름

본 문서는 피그마 디자인 스크린샷을 기반으로 작성된 앱의 전체 구조와 화면 흐름을 정리한 문서입니다.

**작성일**: 2026-01-15  
**기준**: 피그마 스크린샷 (specs/앱 제작 피그마 스크린샷/)

## 프로젝트 개요

- **앱 유형**: 선결제 방식의 식당 예약 앱
- **예시 도메인**: 카레 프렌차이즈 (코코이찌방야, 아비꼬, 토모토 카레 등)
- **주요 특징**: 예약 시 메뉴를 미리 주문하고 결제하는 선결제 시스템

---

## 화면 목록

### 인증 관련 화면
1. **초기화면** (`0. 초기화면.png`)
   - 앱 시작 화면
   - 스플래시 또는 초기 진입 화면

2. **로그인 화면** (`01. 로그인 화면.png`)
   - 사용자 로그인
   - 소셜 로그인 (Google 등) 지원 가능

3. **회원가입 화면** (`03. 회원가입 화면.png`)
   - 신규 사용자 회원가입
   - 고객 정보 입력 (이름, 전화번호, 이메일, 비밀번호)

### 메인 기능 화면
4. **지역 선택 화면** (`04. 지역 선택 화면.png`)
   - 예약할 지역 선택
   - 지역별 식당 검색을 위한 진입점

5. **지도 화면 1** (`05. 지도 화면 1.png`)
   - 지도 기반 식당 위치 표시
   - 식당 마커 및 정보 표시

6. **지도 화면 2** (`06. 지도 화면 2.png`)
   - 지도 화면의 다른 상태 또는 상세 정보

7. **예약화면** (`07. 예약화면 1.png`)
   - 예약 정보 입력 시작
   - 날짜, 시간, 인원 선택

8. **테이블 배치화면** (`12. 테이블 배치화면.png`)
   - 식당 내 테이블 배치도 표시
   - 테이블 선택 및 예약 가능 여부 확인

9. **메뉴화면 1** (`09. 메뉴화면 1.png`)
    - 식당 메뉴 목록 표시
    - 메뉴 카테고리 및 기본 정보

10. **메뉴화면 2** (`10. 메뉴화면 2.png`)
    - 메뉴 상세 정보
    - 옵션 선택 화면

11. **메뉴 화면 3** (`11. 메뉴 화면 3.png`)
    - 메뉴 주문 및 장바구니
    - 주문 내역 확인

12. **예약 완료 화면** (`13. 예약 완료 화면.png`)
    - 예약 정보 최종 확인
    - 예약 확정 전 최종 검토

13. **예약 확인 화면** (`14. 예약 확인 화면.png`)
    - 예약 완료 후 확인 화면
    - 예약 번호 및 상세 정보 표시

14. **결제 화면** (`15. 결제 화면.png`)
    - 결제 정보 입력
    - Toss Payment 연동
    - 결제 완료 처리

### 사이드 메뉴 (Drawer)
15. **회원정보 drawer** (`회원정보 drawer.png`)
    - 사용자 정보 표시
    - 프로필 정보 확인

### 사용자 관리 화면
16. **회원 정보 수정 화면**
    - 회원정보 drawer에서 별도 화면으로 이동
    - 사용자 정보 수정 (이름, 전화번호)
    - 이메일은 읽기 전용 (수정 불가)
    - **구글 로그인 사용자**: 바로 정보 수정 화면으로 이동
    - **일반 사용자 (로컬 계정)**: 비밀번호 변경 버튼 제공

17. **비밀번호 변경 화면** (일반 사용자 전용)
    - 회원 정보 수정 화면에서 이동
    - 이메일 인증 코드 요청 및 입력
    - 새 비밀번호 입력 및 변경
    - 2단계 프로세스: 인증 코드 검증 → 비밀번호 변경

---

## 화면 흐름도

### 주요 사용자 플로우

#### 1. 신규 사용자 플로우
```
초기화면 → 로그인 화면 → 회원가입 화면 → 지역 선택 화면 → 지도 화면 → 예약화면 → 테이블 배치화면 → 메뉴화면 → 예약 완료 화면 → 결제 화면 → 예약 확인 화면
```

#### 2. 기존 사용자 플로우
```
초기화면 → 로그인 화면 → 지역 선택 화면 → 지도 화면 → 예약화면 → 테이블 배치화면 → 메뉴화면 → 예약 완료 화면 → 결제 화면 → 예약 확인 화면
```

#### 3. 메뉴 주문 플로우
```
지도 화면 (식당 선택) → 메뉴화면 1 → 메뉴화면 2 → 메뉴 화면 3 → 예약화면 → 결제 화면
```

#### 4. 사용자 관리 플로우
```
회원정보 drawer → 회원 정보 수정 화면
  ├─ (구글 로그인 사용자) → 정보 수정 완료
  └─ (일반 사용자) → 비밀번호 변경 화면 → 이메일 인증 코드 입력 → 새 비밀번호 입력 → 변경 완료
```

---

## 화면별 주요 기능

### 인증 화면
- **초기화면**: 앱 초기화 및 권한 요청
- **로그인 화면**: 사용자 인증 (이메일/비밀번호, 소셜 로그인)
- **회원가입 화면**: 신규 사용자 등록

### 식당 검색 및 선택
- **지역 선택 화면**: 지역 기반 식당 필터링
- **지도 화면**: 지도 기반 식당 위치 확인 및 선택
- **테이블 배치화면**: 식당 내 테이블 현황 및 선택

### 예약 프로세스
- **예약화면 1, 2**: 예약 정보 입력 (날짜, 시간, 인원, 테이블)
- **예약 완료 화면**: 예약 정보 최종 확인
- **예약 확인 화면**: 예약 완료 후 확인

### 메뉴 및 주문
- **메뉴화면 1, 2, 3**: 메뉴 조회, 옵션 선택, 장바구니 관리

### 결제 (선결제 방식)
- **결제 화면**: 예약 시 메뉴 주문과 함께 결제 진행 (Toss Payment 연동)
- **특징**: 예약 확정 전에 메뉴를 선택하고 결제를 완료해야 예약이 확정됨

### 사용자 관리
- **회원정보 drawer**: 사용자 정보 조회
- **회원 정보 수정 화면**: 사용자 정보 수정 (별도 화면)
  - 구글 로그인 사용자: 바로 정보 수정 화면으로 이동
  - 일반 사용자 (로컬 계정): 비밀번호 변경 버튼 제공
- **비밀번호 변경 화면**: 일반 사용자 전용 비밀번호 변경 (이메일 인증 필요)

---

## 데이터베이스 연동 포인트

### 각 화면에서 필요한 데이터

1. **로그인/회원가입 화면**
   - `customer` 테이블: 사용자 인증 및 등록

2. **지역 선택 화면**
   - `store` 테이블: 지역별 식당 목록 조회

3. **지도 화면**
   - `store` 테이블: 식당 위치 정보 (위도, 경도)
   - `store_image`: 식당 이미지

4. **예약화면**
   - `store` 테이블: 식당 정보
   - `store_table` 테이블: 테이블 정보 및 사용 가능 여부
   - `weather` 테이블: 날씨 정보 (예약 시점)
   - `reserve` 테이블: 예약 정보 저장

5. **테이블 배치화면**
   - `store_table` 테이블: 테이블 배치 정보 (`store_placement`)
   - `store_table` 테이블: 테이블 사용 가능 여부 (`store_table_inuse`)

6. **메뉴화면**
   - `menu` 테이블: 메뉴 목록 및 상세 정보
   - `option` 테이블: 추가 메뉴 옵션

7. **예약 완료/확인 화면**
   - `reserve` 테이블: 예약 정보 조회
   - `pay` 테이블: 결제 내역 조회

8. **결제 화면**
   - `reserve` 테이블: 예약 정보 업데이트 (`payment_key`, `payment_status`)
   - `pay` 테이블: 결제 내역 저장
   - `menu`, `option` 테이블: 주문한 메뉴 및 옵션 정보

9. **회원정보 화면**
   - `customer` 테이블: 사용자 정보 조회 및 수정
   - `password_reset_auth` 테이블: 비밀번호 변경 인증 코드 (일반 사용자)

---

## 구현 우선순위 제안

### Phase 1: 기본 인증 및 식당 조회
1. 초기화면
2. 로그인 화면
3. 회원가입 화면
4. 지역 선택 화면
5. 지도 화면

### Phase 2: 예약 기능
6. 예약화면 1, 2
7. 테이블 배치화면
8. 예약 완료 화면
9. 예약 확인 화면

### Phase 3: 메뉴 및 결제
10. 메뉴화면 1, 2, 3
11. 결제 화면

### Phase 4: 사용자 관리
12. 회원정보 drawer
13. 회원 정보 수정 화면
14. 비밀번호 변경 화면 (일반 사용자 전용)

---

## API 엔드포인트 설계 제안

### 인증 관련
- `POST /api/auth/login` - 로그인
- `POST /api/auth/register` - 회원가입
- `GET /api/auth/me` - 현재 사용자 정보 조회
- `PUT /api/auth/me` - 사용자 정보 수정

### 식당 관련
- `GET /api/stores` - 식당 목록 조회 (지역 필터링)
- `GET /api/stores/{store_seq}` - 식당 상세 정보 조회
- `GET /api/stores/{store_seq}/tables` - 식당 테이블 목록 조회
- `GET /api/stores/{store_seq}/tables/available` - 사용 가능한 테이블 조회

### 예약 관련
- `POST /api/reserves` - 예약 생성
- `GET /api/reserves` - 예약 목록 조회 (사용자별)
- `GET /api/reserves/{reserve_seq}` - 예약 상세 정보 조회
- `PUT /api/reserves/{reserve_seq}` - 예약 수정
- `DELETE /api/reserves/{reserve_seq}` - 예약 취소

### 메뉴 관련
- `GET /api/stores/{store_seq}/menus` - 식당 메뉴 목록 조회
- `GET /api/menus/{menu_seq}` - 메뉴 상세 정보 조회
- `GET /api/menus/{menu_seq}/options` - 메뉴 옵션 목록 조회

### 결제 관련
- `POST /api/payments` - 결제 생성
- `GET /api/payments/{pay_id}` - 결제 정보 조회
- `POST /api/payments/{pay_id}/confirm` - 결제 확인 (Toss Payment)

### 날씨 관련
- `GET /api/weather` - 날씨 정보 조회 (날짜별)

---

## 참고 사항

1. **화면 번호 불일치**: 파일명에 `02.`가 없고 `03.`이 바로 이어짐 (의도된 것일 수 있음)

2. **메뉴 화면**: 3개의 메뉴 화면이 있어 단계별 메뉴 선택 프로세스를 나타냄

3. **Drawer**: 사이드 메뉴로 구현될 것으로 예상되며, 회원정보 관련 기능 포함

4. **결제 연동**: Toss Payment를 사용하므로 `reserve` 테이블의 `payment_key`와 `payment_status` 필드 활용

5. **테이블 배치**: `store_placement` 필드에 테이블 배치 정보가 저장되며, 이를 시각화하여 표시

---

## 변경 이력

- **2026-01-15**: 초기 문서 작성
  - 피그마 스크린샷 기반 화면 구조 정리
  - 화면 흐름도 작성
  - 데이터베이스 연동 포인트 정리
  - API 엔드포인트 설계 제안

- **2026-01-20**: 회원 정보 수정 화면 구조 수정
  - 회원 정보 수정이 drawer가 아닌 별도 화면으로 변경됨을 반영
  - 비밀번호 변경 화면 추가 (일반 사용자 전용, 이메일 인증 필요)
  - 구글 로그인 사용자와 일반 사용자의 화면 흐름 차이 명시
