# FastAPI 로컬 서버 실행 가이드

본 문서는 FastAPI 서버를 로컬 환경에서 실행하는 방법을 설명합니다.

**작성일**: 2026-01-15  
**작성자**: 김택권

---

## 실행 방법

### 방법 1: uvicorn 명령어 사용 (권장)

터미널에서 `fastapi/` 디렉토리로 이동한 후 다음 명령어를 실행합니다:

```bash
# fastapi 디렉토리로 이동
cd fastapi

# 가상 환경 활성화 (이미 생성되어 있는 경우)
source venv/bin/activate  # macOS/Linux
# 또는
venv\Scripts\activate  # Windows

# 서버 실행 (개발 모드 - 코드 변경 시 자동 재시작)
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

**옵션 설명**:

- `--reload`: 코드 변경 시 자동으로 서버 재시작 (개발 모드)
- `--host 0.0.0.0`: 모든 네트워크 인터페이스에서 접근 가능
- `--port 8000`: 포트 번호 (기본값: 8000)

### 방법 2: main.py 직접 실행

```bash
# fastapi 디렉토리로 이동
cd fastapi

# 가상 환경 활성화
source venv/bin/activate  # macOS/Linux
# 또는
venv\Scripts\activate  # Windows

# main.py 직접 실행
python app/main.py
```

이 방법은 `main.py` 파일 하단의 코드를 사용합니다:

```python
if __name__ == "__main__":
    import uvicorn
    uvicorn.run(app, host="0.0.0.0", port=8000)
```

---

## 실행 전 확인 사항

### 1. 가상 환경 확인

가상 환경이 활성화되어 있는지 확인합니다:

```bash
# 가상 환경 활성화 확인 (프롬프트 앞에 (venv) 표시됨)
which python  # macOS/Linux: venv/bin/python 경로 확인
```

가상 환경이 없으면 생성합니다:

```bash
cd fastapi
python -m venv venv
source venv/bin/activate  # macOS/Linux
# 또는
venv\Scripts\activate  # Windows
```

### 2. 의존성 설치 확인

필요한 패키지가 설치되어 있는지 확인합니다:

```bash
# 가상 환경 활성화 후
pip install -r requirements.txt
```

**필요한 패키지**:

- fastapi
- uvicorn
- pymysql
- pydantic
- python-dotenv

### 3. 데이터베이스 설정 확인

`fastapi/app/database/connection.py` 파일에서 데이터베이스 연결 정보를 확인합니다:

```python
DB_CONFIG = {
    'host': 'cheng80.myqnapcloud.com',
    'user': 'team0101',
    'password': 'qwer1234',
    'database': 'table_now_db',
    'charset': 'utf8mb4',
    'port': 13306
}
```

---

## 서버 실행 확인

서버가 정상적으로 실행되면 다음과 같은 메시지가 표시됩니다:

```
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
INFO:     Started reloader process [xxxxx] using WatchFiles
INFO:     Started server process [xxxxx]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
```

---

## API 접근 방법

서버 실행 후 다음 URL로 접근할 수 있습니다:

### 1. API 문서 (Swagger UI)

- URL: http://localhost:8000/docs
- 기능: 인터랙티브 API 문서 및 테스트 가능

### 2. API 문서 (ReDoc)

- URL: http://localhost:8000/redoc
- 기능: API 문서 읽기 전용 버전

### 3. 루트 엔드포인트

- URL: http://localhost:8000/
- 기능: API 정보 확인

### 4. 헬스 체크

- URL: http://localhost:8000/health
- 기능: 서버 상태 확인

### 5. Customer API 엔드포인트

- 전체 고객 조회: http://localhost:8000/api/customer
- 특정 고객 조회: http://localhost:8000/api/customer/{customer_seq}
- 회원가입: http://localhost:8000/api/customer/register (POST)
- 로그인: http://localhost:8000/api/customer/login (POST)

---

## API 테스트 방법

### Swagger UI에서 테스트

1. 브라우저에서 http://localhost:8000/docs 접속
2. 원하는 엔드포인트 클릭
3. "Try it out" 버튼 클릭
4. 필요한 파라미터 입력
5. "Execute" 버튼 클릭
6. 응답 결과 확인

### curl 명령어로 테스트

**회원가입 테스트**:

```bash
curl -X POST "http://localhost:8000/api/customer/register" \
  -H "Content-Type: application/x-www-form-urlencoded" \
  -d "customer_name=홍길동" \
  -d "customer_phone=010-1234-5678" \
  -d "customer_email=hong@example.com" \
  -d "customer_pw=password123"
```

**로그인 테스트**:

```bash
curl -X POST "http://localhost:8000/api/customer/login" \
  -H "Content-Type: application/x-www-form-urlencoded" \
  -d "customer_email=hong@example.com" \
  -d "customer_pw=password123"
```

**전체 고객 조회**:

```bash
curl "http://localhost:8000/api/customer"
```

---

## 문제 해결

### 포트가 이미 사용 중인 경우

다른 포트로 실행:

```bash
uvicorn app.main:app --reload --host 0.0.0.0 --port 8001
```

또는 사용 중인 프로세스 종료:

```bash
# 포트 8000을 사용하는 프로세스 찾기
lsof -i :8000  # macOS/Linux
netstat -ano | findstr :8000  # Windows

# 프로세스 종료
kill -9 [PID]  # macOS/Linux
taskkill /PID [PID] /F  # Windows
```

### 데이터베이스 연결 오류

1. `fastapi/app/database/connection.py` 파일에서 연결 정보 확인
2. 데이터베이스 서버가 실행 중인지 확인
3. 네트워크 연결 확인 (원격 데이터베이스인 경우)

### 모듈을 찾을 수 없는 오류

```bash
# 가상 환경이 활성화되어 있는지 확인
which python

# 의존성 재설치
pip install -r requirements.txt
```

---

## 서버 종료

서버를 종료하려면:

- 터미널에서 `Ctrl + C` 입력

---

## 변경 이력

- **2026-01-15**: 초기 문서 작성 (작성자: 김택권)
  - FastAPI 로컬 서버 실행 방법 정리
  - uvicorn 명령어 및 main.py 실행 방법 설명
  - API 접근 방법 및 테스트 방법 추가
  - 문제 해결 가이드 추가
